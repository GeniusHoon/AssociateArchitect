@startuml
skinparam actorStyle awesome
actor "사용자" as user

package "스마트홈 전기관리 시스템" {
  package "홈 게이트웨이" {
    control ":GatewayController" as GatewayCtrl
    "application logic" ":AnomalyDetectionModel" as GatewayADM
    entity ":PowerUsageData" as PUD_GW
  }

  package "클라우드 플랫폼" {
    control ":AnomalyDetectionController" as CloudADC
    control ":DataManager" as DM
    entity ":AnomalyLog" as AL
    boundary ":NotificationInterface" as NI
  }
}

' This interaction starts within the Gateway
GatewayCtrl -> GatewayADM: 1: anomalyResult := analyzeData(realtimeData)
GatewayADM -> PUD_GW: 1.1: getRealtimeUsage()
PUD_GW --> GatewayADM: realtimeData

'alt anomalyResult is true
  GatewayCtrl -> CloudADC: 1.2: notifyAnomaly(anomalyResult)
  CloudADC -> DM: 1.2.1: saveLog(anomalyResult)
  DM -> AL: 1.2.1.1: createLog()
  CloudADC -> NI: 1.2.2: sendNotification(userID, message)
  NI -> user: 1.2.2.1: pushToDevice()
'end
@enduml